<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>首页</title>
    <link href="../bootstrap/css/bootstrap.css" rel="stylesheet" media="screen">
    <link href="../bootstrap/css/bootstrap-table.min.css" rel="stylesheet" type="text/css">
    <link href="../bootstrap/css/components.min.css" rel="stylesheet" type="text/css">
    <script type="text/javascript" src="../bootstrap/js/jquery.js"></script>
    <script type="text/javascript" src="../bootstrap/js/bootstrap-table.js"></script>
    <script type="text/javascript" src="../bootstrap/js/bootstrap.js"></script>

    <style>
        table td,th{
            text-align:center;vertical-align:middle;
            vertical-align:middle !important;
            word-break: break-all;
        }
        table{
            table-layout:fixed;
        }
    </style>
</head>
<body>

<div class="templatemo-content col-1 light-gray-bg">
    <div class="templatemo-top-nav-container">
        <div class="row">
            <nav class="templatemo-top-nav col-lg-12 col-md-12">
                <li>
                    <a href="">发起项目列表管理</a>
                </li>
            </nav>
        </div>
    </div>
    <textarea class="form-control" rows="3"></textarea>
</div>
    <!--正文部分-->
    <div style="background: #E8E8E8;height: 60rem;">

        <div class="templatemo-content-container">
            <div class="templatemo-content-widget no-padding">
                <!--表头-->
                <div class="panel-heading templatemo-position-relative">
                    <h2 class="text-uppercase">发起项目列表</h2></div>
                <div class="panel panel-default table-responsive" id="mainContent">

                </div>
            </div>
        </div>
    </div>

    <div class="pagination-wrap" id="callBackPager">
    </div>
    <footer class="text-right">
        <p>Copyright &copy; 2018 Company Name | Designed by
            <a href="http://www.csdn.com" target="_parent">csdn</a>
        </p>
    </footer>


<script type="text/javascript">

    var testboke = {
        "code":200,
        "message":null,
        "data":{
            "total":17,//总条数
            "size":10,//分页大小-默认为0
            "pages":2,//总页数
            "current":1,//当前页数
            "records":[//author-riverLethe-double-slash-note数据部分
                {
                    "id":17,//项目id
                    "userName":"Night夜",//发起人名称
                    "companyName":"康佰裕",//发起人公司名称
                    "ptypeName":"13",//发起项目类别
                    "pask":"13",
                    "pname":"13",
                    "pdesc":"13"
                },
                {
                    "id":16,
                    "userName":"Night夜",
                    "companyName":"康佰裕",
                    "ptypeName":"12",
                    "pask":"12",
                    "pname":"12",
                    "pdesc":"12"
                },
                {
                    "id":15,
                    "userName":"BB机",
                    "companyName":"北京电影",
                    "ptypeName":"11",
                    "pask":"11",
                    "pname":"11",
                    "pdesc":"11"
                },
                {
                    "id":14,
                    "userName":"BB机",
                    "companyName":"北京电影",
                    "ptypeName":"9",
                    "pask":"9",
                    "pname":"9",
                    "pdesc":"9"
                },
                {
                    "id":13,
                    "userName":"BB机",
                    "companyName":"北京电影",
                    "ptypeName":"7",
                    "pask":"7",
                    "pname":"7",
                    "pdesc":"7"
                },
                {
                    "id":12,
                    "userName":"Night夜",
                    "companyName":"康佰裕",
                    "ptypeName":"6",
                    "pask":"6",
                    "pname":"6",
                    "pdesc":"6"
                },
                {
                    "id":11,
                    "userName":"BB机",
                    "companyName":"北京电影",
                    "ptypeName":"5",
                    "pask":"5",
                    "pname":"5",
                    "pdesc":"5"
                },
                {
                    "id":10,
                    "userName":"Night夜",
                    "companyName":"康佰裕",
                    "ptypeName":"4",
                    "pask":"4",
                    "pname":"4",
                    "pdesc":"4"
                },
                {
                    "id":9,
                    "userName":"BB机",
                    "companyName":"北京电影",
                    "ptypeName":"3",
                    "pask":"3",
                    "pname":"3",
                    "pdesc":"3"
                },
                {
                    "id":8,
                    "userName":"Night夜",
                    "companyName":"康佰裕",
                    "ptypeName":"2",
                    "pask":"2",
                    "pname":"2",
                    "pdesc":"2"
                }
            ]
        }
    }

    var currPage = 1;
    var totalCount;
    var dataLIst = [];
    window.onload = function() {
        /*取到总条数*/
        /*每页显示多少条  10条*/
        var limit = 10;
        data(currPage, limit)
        //console.log(totalCount)
        createTable(1, limit, totalCount);
        $('#callBackPager').extendPagination({
            totalCount: totalCount,
            limit: limit,
            callback: function(curr, limit, totalCount) {
                data(curr, limit)
            }
        });
    }

    function data(curr, limit) {
        //console.log("tot:"+totalCount)
        /*拿到总数据*/
        totalCount = testboke.data.total; //取出来的是数据总量
        dataLIst = testboke.data.records; // 将数据放到一个数组里面（dataLIst 还未声明，莫着急）
        createTable(curr, limit, totalCount);
        console.log("tot:" + totalCount)
    }

    function createTable(currPage, limit, total) {
        var html = [],
            showNum = limit;
        if (total - (currPage * limit) < 0) showNum = total - ((currPage - 1) * limit);
        html.push(' <table class="table table-striped table-bordered templatemo-user-table" style="margin-left: 0;">');
        html.push(' <thead><tr><th>序号</th><th>项目名称</th><th>类别</th><th>发起人</th><th>单位</th><th>详情</th><th>操作</th></tr></thead><tbody>');

        for (var i = 0; i < showNum; i++) {
            html.push('<tr>');
            html.push('<td>' + dataLIst[i].id + '</td>');
            html.push('<td>' + dataLIst[i].pname + '</td>');
            html.push('<td>' + dataLIst[i].ptypeName + '</td>');
            html.push('<td>' + dataLIst[i].userName + '</td>');
            html.push('<td>' + dataLIst[i].companyName + '</td>');
            html.push('<td><a href="project_details_init.html?id=' + dataLIst[i].id + '" class="templatemo-edit-btn">详情</a></td>');
            html.push('<td><button class="templatemo-edit-btn" onclick=checkproject(' + dataLIst[i].id + ',"1")>同意' +
                '</button> <button class="templatemo-edit-btn" onclick=checkproject(' + dataLIst[i].id + ',"2")>拒绝</button></td>');
            html.push('</tr>');
        }
        html.push('</tbody></table>');
        var mainObj = $('#mainContent');
        mainObj.empty();
        mainObj.html(html.join(''));
    }
</script>
</body>
</html>